:py:mod:`goblin_cbm_runner.geo_cbm_runner.geo_runner`
=====================================================

.. py:module:: goblin_cbm_runner.geo_cbm_runner.geo_runner

.. autoapi-nested-parse::

   Geo CBM Runner Module
   =====================
   This module provides functionalities to run CBM simulations focused on Irish historic afforestation at the catchment level,
   utilizing geo-specific data preparation and management for Irish catchment data.



Module Contents
---------------

Classes
~~~~~~~

.. autoapisummary::

   goblin_cbm_runner.geo_cbm_runner.geo_runner.GeoRunner




.. py:class:: GeoRunner(geo_data_manager)


   The Runner class orchestrates the execution of Carbon Budget Model (CBM) simulations
   for various scenarios, including baseline, afforestation, and user-defined forest management strategies.
   It utilizes annualized data to estimate carbon stock or flux over specified years.

   This class manages input data preparation, CBM simulation setups, and the execution process, generating outputs like carbon stocks and fluxes for various scenarios.

   :param geo_data_manager: Instance of GeoDataManager for managing geo-specific data.
   :type geo_data_manager: GeoDataManager

   .. attribute:: paths_class

      Instance of Paths for setting up directory paths for CBM simulation input data.

      :type: Paths

   .. attribute:: sit_path

      Directory path for SIT data.

      :type: str

   .. attribute:: defaults_db

      Path to the default database.

      :type: str

   .. attribute:: path

      Directory path where input data is stored.

      :type: str

   .. attribute:: baseline_conf_path

      Directory path for baseline configuration data.

      :type: str

   .. attribute:: sc_fetcher

      Instance of ScenarioDataFetcher for fetching scenario data.

      :type: ScenarioDataFetcher

   .. attribute:: forest_end_year

      The final year of the forest simulation period.

      :type: int

   .. attribute:: cbm_data_class

      Instance of DataFactory for preparing CBM data.

      :type: DataFactory

   .. attribute:: INDEX

      List of unique identifiers for each simulation scenario.

      :type: list

   .. attribute:: SIM_class

      Instance of CBMSim for running CBM simulations.

      :type: CBMSim

   .. attribute:: baseline_years

      List of baseline years for the simulations.

      :type: list

   .. attribute:: baseline_year_range

      Range of baseline years for the simulations.

      :type: list

   .. attribute:: forest_baseline_dataframe

      DataFrame containing forest baseline data.

      :type: pd.DataFrame

   .. method:: generate_input_data()

      
      Generates input data required for CBM simulations including those based on user-defined forest management strategies.
      Cleans the data directory, creates necessary subdirectories, and prepares scenario-specific input files.
      

   .. method:: run_aggregate_scenarios()

      
      Executes CBM simulations for a set of scenarios including user-defined management strategies, generating and aggregating carbon stock data across these scenarios.
      

   .. method:: run_flux_scenarios()

      
      Conducts CBM simulations to calculate carbon flux data for various scenarios including user-defined management strategies, merging and aggregating results.
      
      

   .. py:property:: get_forest_baseline_dataframe

      Returns the forest baseline DataFrame.

      :returns: Forest baseline DataFrame.
      :rtype: pd.DataFrame

   .. py:method:: _generate_base_input_data()

      Generates the base input data for the CBM runner.

      This method cleans the baseline data directory, and then generates various input files
      required for the CBM runner, such as classifiers, configuration JSON, age classes,
      yield curves, inventory, disturbance events, disturbance types, and transition rules.

      :param None:

      :returns: None


   .. py:method:: _generate_input_data()

      Generates input data for the CBM runner.

      This method cleans the data directory, creates necessary directories,
      and generates various input files required for the CBM runner.

      :param None:

      :returns: None


   .. py:method:: run_aggregate_scenarios()

      Executes CBM simulations for a set of scenarios, generating and aggregating carbon stock data across scenarios, including those derived from user-defined forest management strategies.

      Merges scenario-specific data with baseline data to provide a comprehensive view of carbon stocks under various management strategies.

      :returns: Aggregated carbon stock data across all scenarios.
      :rtype: pd.DataFrame


   .. py:method:: run_flux_scenarios()

      Conducts CBM simulations to calculate and aggregate carbon flux data for various scenarios, including those with user-defined forest management strategies.

      This process helps in understanding the impact of different management practices on carbon dynamics within forest ecosystems.

      :returns: Aggregated carbon flux data across all scenarios.
      :rtype: pd.DataFrame


   .. py:method:: _add_years(sc)

      Adds additional years to the DataFrame.

      :param sc: Scenario index.
      :type sc: int

      :returns: DataFrame with additional years.
      :rtype: pd.DataFrame



